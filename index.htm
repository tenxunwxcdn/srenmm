<html lang="zh-CN">
<head>
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="yes" name="apple-touch-fullscreen">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="320" name="MobileOptimized">
    <title>加载中...</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #f5f5f5;
            overflow: hidden;
            height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        .container {
            width: 100px;
            height: 100px;
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: rotate-move 2s ease-in-out infinite;
            will-change: transform;
        }

        .dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
            will-change: transform;
        }

        .dot-3 {
            background-color: #f74d75;
            animation: dot-3-move 2s ease infinite;
        }

        .dot-2 {
            background-color: #10beae;
            animation: dot-2-move 2s ease infinite;
        }

        .dot-1 {
            background-color: #ffe386;
            animation: dot-1-move 2s ease infinite;
        }

        @keyframes dot-3-move {
            20% { transform: scale(1) }
            45% { transform: translateY(-18px) scale(.45) }
            60% { transform: translateY(-25px) scale(.45) }
            80% { transform: translateY(-25px) scale(.45) }
            100% { transform: translateY(0px) scale(1) }
        }

        @keyframes dot-2-move {
            20% { transform: scale(1) }
            45% { transform: translate(-16px, 12px) scale(.45) }
            60% { transform: translate(-20px, 15px) scale(.45) }
            80% { transform: translate(-20px, 15px) scale(.45) }
            100% { transform: translateY(0px) scale(1) }
        }

        @keyframes dot-1-move {
            20% { transform: scale(1) }
            45% { transform: translate(16px, 12px) scale(.45) }
            60% { transform: translate(20px, 15px) scale(.45) }
            80% { transform: translate(20px, 15px) scale(.45) }
            100% { transform: translateY(0px) scale(1) }
        }

        @keyframes rotate-move {
            55% { transform: translate(-50%, -50%) rotate(0deg) }
            80% { transform: translate(-50%, -50%) rotate(360deg) }
            100% { transform: translate(-50%, -50%) rotate(360deg) }
        }

        .content {
            height: 100%;
            width: 100%;
            position: fixed;
            left: 0;
            top: 0;
            border: none;
        }

        .loading-info {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 80%;
            max-width: 400px;
        }

        .loading-text {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .target-title {
            color: #333;
            font-size: 16px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding: 0 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="dot dot-1"></div>
        <div class="dot dot-2"></div>
        <div class="dot dot-3"></div>
    </div>
    <div class="loading-info">
        <div class="loading-text">正在跳转到以下页面...</div>
        <div class="target-title">加载中，请稍候...</div>
    </div>

    <script>
        // 处理URL参数并加载目标页面
        try {
            const urlParams = new URLSearchParams(window.location.search);
            const encodedParam = urlParams.get('c');
            
            if (!encodedParam) {
                throw new Error('缺少参数c');
            }

            let targetUrl;
            try {
                targetUrl = atob(encodedParam);
            } catch (e) {
                throw new Error('参数解码失败');
            }

            if (!targetUrl.includes('http')) {
                throw new Error('无效的URL地址');
            }

            // 更新页面标题为加载状态
            document.title = '加载中...';
            
            // 获取DOM元素
            const container = document.querySelector('.container');
            const loadingInfo = document.querySelector('.loading-info');
            const targetTitleEl = document.querySelector('.target-title');

            // 创建并插入iframe
            const iframe = document.createElement('iframe');
            iframe.className = 'content';
            iframe.src = targetUrl;
            iframe.style.display = 'none'; // 初始隐藏iframe
            
            // 监听iframe加载事件获取标题
            iframe.onload = function() {
                try {
                    // 尝试获取目标页面标题
                    let targetTitle = '未知页面';
                    if (this.contentWindow && this.contentWindow.document) {
                        targetTitle = this.contentWindow.document.title || targetTitle;
                        // 更新当前页面标题
                        document.title = targetTitle;
                    }
                    // 更新显示的标题
                    targetTitleEl.textContent = targetTitle;
                    
                    // 绑定鼠标滚轮事件
                    bindMouseWheel(this);
                    
                } catch (e) {
                    console.warn('跨域限制，无法获取页面标题:', e.message);
                }
            };
            
            document.body.appendChild(iframe);

            // 1.5秒后隐藏加载动画，显示iframe
            setTimeout(() => {
                container.style.display = 'none';
                loadingInfo.style.display = 'none';
                iframe.style.display = 'block';
            }, 1500);

            console.log('加载目标URL:', targetUrl);

        } catch (error) {
            console.error('加载失败:', error.message);
            const container = document.querySelector('.container');
            const loadingText = document.querySelector('.loading-text');
            const targetTitleEl = document.querySelector('.target-title');
            
            container.style.display = 'none';
            loadingText.textContent = '加载失败';
            loadingText.style.color = '#f74d75';
            targetTitleEl.textContent = error.message;
            targetTitleEl.style.color = '#f74d75';
            document.title = '加载失败';
        }

        // 鼠标滚轮控制函数
        const firefox = navigator.userAgent.indexOf('Firefox') !== -1;

        function handleMouseWheel(e, doc) {
            if (e.preventDefault) {
                e.preventDefault();
            } else {
                e.returnValue = false;
            }

            const isUp = firefox ? e.detail < 0 : e.wheelDelta > 0;
            const scrollStep = 50;
            const currentScroll = doc.body.scrollTop || doc.documentElement.scrollTop;
            doc.body.scrollTop = doc.documentElement.scrollTop = isUp ? currentScroll - scrollStep : currentScroll + scrollStep;
        }

        function bindMouseWheel(iframe) {
            try {
                const doc = iframe.contentWindow.document;
                
                if (firefox) {
                    doc.addEventListener('DOMMouseScroll', (e) => handleMouseWheel(e, doc), false);
                } else {
                    doc.onmousewheel = (e) => handleMouseWheel(e || iframe.contentWindow.event, doc);
                }
            } catch (e) {
                console.warn('跨域限制，无法控制iframe滚动:', e.message);
            }
        }
    </script>
</body>
</html>
