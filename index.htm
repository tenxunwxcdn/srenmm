<html lang="zh-CN">
<head>
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="yes" name="apple-touch-fullscreen">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="320" name="MobileOptimized">
    <title>页面加载中</title>
    <style>
        /* 基础样式重置 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #f5f5f5;
            overflow: hidden;
            height: 100vh;
        }

        .container {
            width: 100px;
            height: 100px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: rotate-move 2s ease-in-out infinite;
            will-change: transform; /* 优化动画性能 */
        }

        .dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: #000;
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
            will-change: transform; /* 优化动画性能 */
        }

        .dot-3 {
            background-color: #f74d75;
            animation: dot-3-move 2s ease infinite;
        }

        .dot-2 {
            background-color: #10beae;
            animation: dot-2-move 2s ease infinite;
        }

        .dot-1 {
            background-color: #ffe386;
            animation: dot-1-move 2s ease infinite;
        }

        @keyframes dot-3-move {
            20% { transform: scale(1) }
            45% { transform: translateY(-18px) scale(.45) }
            60% { transform: translateY(-25px) scale(.45) }
            80% { transform: translateY(-25px) scale(.45) }
            100% { transform: translateY(0px) scale(1) }
        }

        @keyframes dot-2-move {
            20% { transform: scale(1) }
            45% { transform: translate(-16px, 12px) scale(.45) }
            60% { transform: translate(-20px, 15px) scale(.45) }
            80% { transform: translate(-20px, 15px) scale(.45) }
            100% { transform: translateY(0px) scale(1) }
        }

        @keyframes dot-1-move {
            20% { transform: scale(1) }
            45% { transform: translate(16px, 12px) scale(.45) }
            60% { transform: translate(20px, 15px) scale(.45) }
            80% { transform: translate(20px, 15px) scale(.45) }
            100% { transform: translateY(0px) scale(1) }
        }

        @keyframes rotate-move {
            55% { transform: translate(-50%, -50%) rotate(0deg) }
            80% { transform: translate(-50%, -50%) rotate(360deg) }
            100% { transform: translate(-50%, -50%) rotate(360deg) }
        }

        .content {
            height: 100%;
            width: 100%;
            position: fixed;
            left: 0;
            top: 0;
            border: none; /* 移除iframe默认边框 */
        }

        .loading-text {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #666;
            font-family: sans-serif;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="dot dot-1"></div>
        <div class="dot dot-2"></div>
        <div class="dot dot-3"></div>
    </div>
    <div class="loading-text">加载中...</div>

    <script>
        // 处理URL参数并加载目标页面
        try {
            // 获取并解码URL参数
            const urlParams = new URLSearchParams(window.location.search);
            const encodedParam = urlParams.get('c');
            
            if (!encodedParam) {
                throw new Error('缺少参数c');
            }

            let targetUrl;
            try {
                targetUrl = atob(encodedParam);
            } catch (e) {
                throw new Error('参数解码失败');
            }

            // 验证URL合法性
            if (!targetUrl.includes('http')) {
                throw new Error('无效的URL地址');
            }

            // 1.5秒后隐藏加载动画
            const container = document.querySelector('.container');
            const loadingText = document.querySelector('.loading-text');
            
            setTimeout(() => {
                container.style.display = 'none';
                loadingText.style.display = 'none';
            }, 1500);

            // 创建并插入iframe
            const iframe = document.createElement('iframe');
            iframe.className = 'content';
            iframe.src = targetUrl;
            iframe.onload = function() {
                bindMouseWheel(this);
            };
            document.body.appendChild(iframe);

            console.log('加载目标URL:', targetUrl);

        } catch (error) {
            // 错误处理：显示错误信息并隐藏加载动画
            console.error('加载失败:', error.message);
            const container = document.querySelector('.container');
            const loadingText = document.querySelector('.loading-text');
            
            container.style.display = 'none';
            loadingText.textContent = '加载失败: ' + error.message;
            loadingText.style.color = '#f74d75';
        }

        // 鼠标滚轮控制函数
        const firefox = navigator.userAgent.indexOf('Firefox') !== -1;

        function handleMouseWheel(e, doc) {
            // 阻止默认滚动行为
            if (e.preventDefault) {
                e.preventDefault();
            } else {
                e.returnValue = false;
            }

            // 判断滚动方向
            const isUp = firefox ? e.detail < 0 : e.wheelDelta > 0;
            
            // 控制滚动距离
            const scrollStep = 50;
            const currentScroll = doc.body.scrollTop || doc.documentElement.scrollTop;
            doc.body.scrollTop = doc.documentElement.scrollTop = isUp ? currentScroll - scrollStep : currentScroll + scrollStep;
        }

        function bindMouseWheel(iframe) {
            try {
                const doc = iframe.contentWindow.document;
                
                // 绑定滚轮事件（兼容不同浏览器）
                if (firefox) {
                    doc.addEventListener('DOMMouseScroll', (e) => handleMouseWheel(e, doc), false);
                } else {
                    doc.onmousewheel = (e) => handleMouseWheel(e || iframe.contentWindow.event, doc);
                }
            } catch (e) {
                console.warn('跨域限制，无法控制iframe滚动:', e.message);
            }
        }
    </script>
</body>
</html>
